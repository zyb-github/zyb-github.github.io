# Linux 学习总结



#### 1、前言

+ Linux内核版本介绍网址： https://www.kernel.org/

+ 网站扫描网址（确认网站服务器是否是linux）：https://www.netcraft.com/

#### 2、分区|挂载

+ 逻辑分区永远从5开始，是系统自动分配的。
+ 为分区分配盘符的过程称为挂载
  - 必须分区的有两个：根分区和swap分区（虚拟内存，在主内存不够的时候使用）
  - 推荐的分区：/boot (启动分区，200MB) 保存启动时需要的数据。

#### 3、Linux各目录的作用

##### 1、/bin/

> 存放系统命令的目录，普通用户和超级用户都可以执行，不过放在/bin/下的命令在单用户模式下也可以执行

##### 2、/sbin/

> 保存和系统环境设置相关的命令，只有超级用户可以使用和这些命令进行系统环境设置，但是有些命令可以允许普通用户查看

##### 3、/user/bin/

> 存放系统命令的目录，普通用户和超级用户都可以执行，这些命令和系统启动无关，在单用户模式下不能执行

##### 4、/user/sbin/

> 存放根文件系统不必要的系统管理命令，例如多数服务程序，只有超级用户可以使用，

##### 5、/boot/

> 系统启动目录，保存系统相关的文件，如内核文件和启动引导程序（grub）文件等

##### 6、/dev/

> 设备文件保存位置，用来保存所有硬件设备文件的

##### 7、/etc/

> 配置文件保存位置，系统内所有采用默认安装方式（rpm安装）的服务的配置文件全部保存在这个目录中，如用户账户和密码，服务的启动脚本，常用服务的配置文件等

#### 4、常用命令

##### 4、1 文件命令

###### 4、1、1 ls

> ls : ls -l 详细信息  文件信息包括文件类型、文件所有者、所属组、其他人、大小、时间、文件名
>
> ls -a 全部文件 包括隐藏文件
>
> ls -h 显示人性化的信息，例如文件大小单位的转换
>
> 文件类型：-开头代表文件  d开头代表目录  l 开头代表软连接
>
> rw- r-- r--      r读   w写  x执行   
>
> 执行权限是做大权限

###### 4、1、2 mkdir  touch创建文件

> mkdir hello  创建hello目录
>
> mkdir -p null/hello      -p 可以递归创建目录，即使null目录不存在
>
> pwd 显示当前目录
>
> touch创建文件

###### 4、1、3 rmdir

> 删除空目录
>
> rmdir /tmp/hello

###### 4、1、4 cp  复制

> cp -rp【源文件或者目录【目标目录】     -r 复制目录  -p 保留文件属性  

###### 4、1、4 mv 剪切文件、改名

> mv 【源文件或者目录】【目标目录】

###### 4、1、5 rm 删除文件

> rm -rf [文件或目录]     -r 删除目录   -f 强制删除   
>
> 万恶之源 rm -rf /*

###### 4、1、6 ln 生成软连接

> ln -s 【源目录或文件】【目标目录】 -s生成软连接  不加-s生成硬链接
>
> 区别：
>
> 软连接相当于快捷方式，如果源文件删除，则不能使用，硬链接相当于备份，并可以监听改变，如果源文件修改，则硬链接跟着修改，如果源文件删除，硬链接依旧可以使用
>
> 硬链接不可以跨分区使用，软连接可以，
>
> 硬链接不能针对目录使用，软连接可以

##### 4、2 权限管理命令

######  4.2.1 chown 所有者命令

> chown 【用户】【文件或者目录】  改变文件或者目录的所有者
>
> chown root_1 hello   改变hello的所有者为root_1

###### 4.2.2 chgrp 所有组命令

> chgrp 【用户组】【文件或目录】

###### 4.2.3 umask 查看用户缺省（默认权限）022

> 777 rwx rwx rwx
>
> 022 --- -w- -w-
>
> 进行逻辑与  得到 rwx r-x r-x 默认新建目录权限  rw- r-- r-- 默认新建文件权限（linux中新建文件会默认去除可执行权限 x）
>
>   
>
> 也可以修改umask默认权限022，   umask 077就是把缺省权限改为077，这样默认新建的文件或者目录权限为：
>
> 777  rwx rwx rwx
>
> 077  - - - rwx rwx   进行逻辑与-->
>
> ​        rwx - - - - - - 目录权限
>
> ​        rw - - - - - - - 文件权限

###### 4.2.1 chmod 更改文件权限

> r = 4  w =2   x =1
>
> rwx = 7

##### 4.3 文件搜索命令

###### 4.3.1 find 文件搜索命令

> find 【搜索范围】【匹配条件】
>
> find /tmp -name init    根据名字搜索
>
> find /tmp -name \*init\*  使用星号通配符
>
> find /tmp -name init??     ？代表一个字符，这个代表查找init后面还有两个字符的文件，例如 initab
>
>  find /tmp -iname int  -i不区分大小写
>
> find /tmp -size  +2048   + 大于 - 小于  不写为等于  单位为0.5KB
>
> find /tmp -user root  查找所有者为root的文件
>
> find /tmp -cmin -5  查找5分钟内被修改过属性的文件或者目录
>
> ​         -amin 访问时间access
>
> ​		-cmin 文件属性change
>
> ​		-mmin 文件内容 modify
>
> find /tmp -size +2048 -a -size -20480  查找大于1M 小于10M的文件
>
> ​		-a 两个条件同事满足
>
> ​		-o 两个条件满足任意一个即可
>
> -type 根据文件类型查找  f表示文件 d表示目录 l表示软连接
>
> -inum 根据i节点查找
>
> 对于查找的结果做命令： -exec ... { } \ ; 固定格式
>
> find /tmp -name test -exec ls -l { } \;

##### 4.4 帮助命令 man  which  whereis help

> man [命令或者配置]      不能写绝对路径，如果存在多个，先读取命令的帮助
>
> which passwd   --> /usr/bin/passwd
>
> whereis passwd   --> passwd: /usr/bin/passwd  /etc/passwd  /usr/share/man/man1/passwd.1.gz  /usr/share/man5/passwd.5.gz
>
>  man passwd   （优先会查找1 命令的帮助文档）
>
> 在linux系统中，1代表命令的帮助， 5代表文件的帮助
>
> 如果打算查找5 文件的帮助文档，则需要命令行   man 5 passwd  就可以了
>
> 
>
> 如果只想要一个简单的命令信息 使用 whatis
>
> whatis ls
>
> 如果只想要一个配置文件的简单信息 使用apropos
>
> apropos services



> help: 查看shell内置命令  例如cd pwd echo

##### 4.5 用户管理命令

###### 4.5.1 useradd  passwd

> useradd 用户名
>
> passwd 用户名   普通用户只能修改自己的密码  root可以修改所有人的密码

###### 4.5.2 who     w

> 显示信息如下
>
> 登录用户名   登录终端（tty本地终端，pts远程登录） 登录时间  IP地址（没写就是本地登录）

##### 4.6 压缩解压命令

###### 4.6.1 gzip  gunzip|gzip -d

> 只能压缩文件，并且不保留源文件

###### 4.6.1 tar

> tar 选项【-zcf】【压缩后文件名】【目录】
>
> -c 打包
>
> -v 显示详细信息
>
> -f 指定文件名
>
> -z 打包同时压缩
>
> -x 解压包

###### 4.6.1 zip   unzip

> linux和windows都支持的压缩格式
>
> zip 【选项-r】【压缩后文件名】【文件或目录】
>
> -r 压缩目录
>
> unzip 解压缩

###### 4.6.1 bzip2  压缩文件 格式.bz2     bunzip2 解压

> bzip2 选项【-k】 【文件】
>
> -k 生成压缩文件并保留源文件
>
> tar -cjf test.tar.bz2 test  可以直接生成.bz2的文件

##### 4.7 网络命令

###### 4.7.1 write

> write <用户名>  给在线用户发信息，以ctrl+d 保存结束

###### 4.7.2 wall

> wall 【message】
>
> 发广播信息，给所有在线用户发信息
>
> wall hello word！

###### 4.7.3 ping

> -c 执行ping次数

###### 4.7.4 ifconfig

> 查看和设置网卡信息

###### 4.7.5 mail

> mail [用户名]   发送邮件 可发给离线用户

###### 4.7.6 last   lastlong

> last   查看目前和过去所有登录用户的信息
>
> lastlong 查询所有用户最后一次登录的信息  -u 【uid】  可以定位到特定用户

###### 4.7.6 traceroute

> 显示数据包到主机间的路径
>
> tracetoute www.baidu.com

###### 4.7.7 netstat

> netstat [选项]
>
> 显示网络相关信息
>
> -t  tcp协议
>
> -u  udp协议
>
> -l  监听
>
> -r 路由
>
> -n  显示ip和端口号
>
> ： netstat -tlun  查看本机监听的端口
>
> ： netstat -an 查看本机所有的网络连接
>
> :   netstat -rn  查看本机路由表

###### 4.7.8 setup  红帽系列特有的配置ip网络命令

##### 4.8 关机和重启命令

###### 4.8.1 shutdown

> shutdown [选项] 时间
>
> -c 取消前一个关机命令
>
>  -h 关机
>
>  -r 重启
>
> shutdown -h now  立即关机
>
> reboot 重启
>
> init 6重启   init 0关机   halt 关机  poweroff 关机（相当于直接断电）

>  init 
>
> 系统运行级别
>
> 0 关机   1 单用户  2不完全多用户（不含NFS服务）  3完全多用户  4未分配  5图形界面  6重启
>
> runlevel   查看当前运行级别

###### 4.8.2 logout 退出

#### 5、VIM

> 刚进入属于命令模式：
>
> 输入 i a o 进入插入模式
>
> a 在光标所在字符后插入
>
> A 在光标所在行尾插入
>
> i 在光标所在字符前插入
>
> I 在光标所在行 行首插入
>
> o 在光标下插入新行
>
> O 在光标上插入新行
>
> 定位命令：
>
> :set nu  设置行号
>
> :set nonu 取消行号
>
> gg 到第一行
>
> G 到最后一行
>
> nG 到第n行
>
> :n 到第n行
>
> $ 移至行尾
>
> 0 移至行首
>
> x 删除光标所在处字符
>
> nx 删除光标所在处后n个字符
>
> dd 删除光标所在行，ndd删除n行
>
> dG 删除光标所在行到文件末尾内容
>
> D 删除光标所在行到行尾内容
>
> :n1,n2d 删除指定范围的行   例如：删除3-7行的内容 :3,7d
>
> -- 复制和剪切
>
> yy 复制当前行
>
> nyy 复制当前行一下n行
>
> dd 剪切当前行
>
> ndd 剪切当前行一下n行
>
> p、P  粘贴在当前光标所在行下或者行上
>
> --快捷方式
>
> r 替换光标处的字符
>
> R从光标开始处开始替换字符，按esc结束
>
> u 取消上一步操作
>
>  
>
> -- 搜索类
>
> /string  搜索指定字符串，搜索时忽略大小写 :set ic
>
> n 搜索指定字符串的下一个指定位置
>
> :%s/old/new/g  全文替换指定字符串  例如 a 替换为b  %s/a/b/g
>
> :n1,n2s/old/new/g  在一定范围内替换指定字符串



> :wq 保存修改并退出 
>
> : w 保存修改
>
> ：w new_filename  另存为指定文件
>
> ZZ 快捷键保存修改并退出
>
> :q!  不保存修改退出
>
> :wq! 强制修改并退出（文件所有者以及root可使用）

> :r 【文件路径】   导入外部文件到光标指定处
>
> :![命令]   可以在不退出vim的情况下，执行linux命令  
>
> :r ![命令]   可以直接导入命令执行结果  例如 导入当前时间 :r!date
>
> 定义快捷键：个性化
>
> :map 快捷键 触发命令
>
> 例如 定义一个快捷键[Ctrl+P]快速注释一行 （也就是给这一行行首添加一个#字符）
>
> :map Ctrl+V+P I#<ESC>   这样就可以了，想快速注释一行就可以在命令行模式直接[Ctrl+P]
>
> 例如定义一个快捷键[Ctrl+B]快速取消一行的注释 （把行首的第一个字符 #删除）
>
> :map Ctrl+V+B 0x  这样就可以了   

>连续行注释：
>
>:n1,n2s/^/#/g   ^代表行首
>
>例如：注释2到5行   :2,5s/^/#/g   
>
>取消注释：  :2,5s/^#//g
>
> 
>
>替换命令   执行之后 在文件中输入mymail，然后空格或者回车，mymail就会自动变成12314234@123.com
>
>:ab mymail  12314234@123.com 
>
> 
>
>永久使用快捷方式或者自定义方式，需要在用户的home路径（root就是root目录，其余账户就是/home/xxxx/）下创建 .vimrc文件，把所有的快捷方式或者自定义快捷键写入就可以永久生效了
>
>

#### 6、软件包管理

##### 6.1.1、软件包分类

> 源码包：脚本安装包
>
> 二进制包：RPM包、系统默认包

##### 6.1.2、RPM包管理-rpm命令管理

>rpm包命名规则：
>
>httpd-2.2.15-15.el6.centos.1.i686.rpm
>
>httpd软件包名  2.2.15软件版本  15软件发布的次数 el6.centos 适合的Linux平台  i686适合的硬件平台  rpm rpm包扩展名
>
>RPM包依赖性
>
>树形依赖：a-->b-->c
>
>环形依赖：a-->b-->c-->a  这种解决方式就是把三个包放在一个安装命令里，同时安装
>
>模块依赖：模块依赖查询网站 www.rpmfind.net   （以.so.2）数字结尾的属于依赖模块，这种包不需要单独安装，一般是安装包含这种so的包就可以了，具体那个包含有这个.so依赖，可以在网站查询

##### 6.1.3、RPM包管理-yum在线管理

>  网络yum源
>
> vim /etc/yum.repos.d/   目录下的都是yum源   其中CentOS-Base.repo属于基础yum源
>
> 文件内容解读：
>
> [base]  容器名称，一定要放在[]中
>
> name 容器说明，可以自己随便写
>
> mirrorlist 镜像站点，这个可以注释
>
> baseurl 我们服务器的yum源服务器的地址，默认是CentOS官方的yum原服务器，是可以使用的，如果觉得慢可以更换地址
>
> enable 此容器是否生效，如果不写或者写成enable=1都是生效的，写成enable=0就是不生效
>
> gpgcheck 如果是1是指RPM的数字证书生效，如果是0则不生效
>
> gpgkey 数字证书的公钥文件保存为止，不用修改
>
> 
>
> yum 命令
>
> yum list  查询所有可用的软件列表
>
> yum search [包关键字] 搜索服务器上所有和关键字相关的包
>
> yum -y install 包名   -y 自动安装不要询问
>
> yum -y update 包名  自动升级
>
> yum -y remove 包名 自动卸载
>
>  
>
> yum grouplist  列出所有可用的软件组列表
>
> yum groupinstall 软件组名  安装指定的软件组
>
> yum groupremove 软件组名 卸载指定的软件组
>
>  
>
> 光盘yum源搭建
>
> 使用mount命令挂载光盘（一般都在/mht目录下新建挂载点）
>
> 例子：mount /dev/cdrom /mnt/cdrom
>
> 让网络yum源失效，（yum是以.rpm结尾的文件进行读取，最快的失效方式就是修改文件后缀）
>
> 修改光盘yum源文件 vim CentOS-Media.repo
>
> 主要修改  baseurl=file///mnt/cdrom          enable=1

##### 6.1.4、RPM包安装

>rpm -ivh 包全名
>
>-i 安装
>
>-v 显示详细信息
>
>-h 显示进度
>
>--nodeps 不检测依赖性
>
> 
>
>RPM包升级
>
>rpm -Uvh 全包名
>
>RPM包卸载
>
>rpm -e 包名
>
>RPM查询
>
>rpm -q 包名      扩展： 加管道符 查询与之相关的包  rpm -qa | grep httpd
>
>rpm -qa 查询所有已经安装的包
>
>-i 查询包的详细信息
>
>-p 查询未安装的包的信息 （后跟包全名）
>
>-l 查询安装位置
>
>rpm -qf 系统文件名
>
>-f 查询系统文件属于哪个软件包（file）
>
>rpm -qR 包名     查询软件包的依赖性
>
>-R 查询软件包的依赖性
>
>-p 查询未安装的包信息
>
> 
>
> rpm -V 包名  查询包是否修改过
>
>

##### 6.1.5、源码包安装

> 区别：安装位置的区别
>
> RPM包安装位置（默认）
>
> /etc/ 配置问价安装目录
>
> /usr/bin/ 可执行目录安装目录
>
> /usr/lib/ 程序所使用的的函数库保存位置
>
> /usr/share/doc/ 基本的软件使用手册保存位置
>
> /usr/share/man/ 帮助文件保存位置
>
>  
>
> 源码包安装过程：(一般都会安装在usr/local/文件夹下)
>
> + 下载源码包  .tar.gz
>
> + 解压缩下载的源码包  tar -zxf 包名
>
> + 进入解压缩命令   目录里面的INSTALL  和README 是安装说明和使用说明，安装之前可以查看INSTALL，里面有安装步骤
>
> + ./configure  软件配置与检查
>
>   > 定义需要的功能选项、检测系统环境是否符合安装要求、把定义好的功能选项和检测系统环境的信息都写入MakeFile文件，用于后续的编辑
>
> + 自定义安装路径： ./configure --prefix=/usr/local/apache2
>
> + make  编辑 （源码变为机器语言二进制）   make clean
>
> + make install 编译安装（正式向自定义目录写入数据，make install之前如果出现错误，只需要执行make clean命令清空就行）
>
> + 源码包的卸载（执行rm -rf 命令把安装目录直接删除就可以了）

##### 6.1.6、脚本安装包

>+ 脚本安装包并不是独立的软件包类型，常见的安装时源码包
>+ 是人为的把安装过程写成了自动安装的脚本

#### 7、用户和用户组管理

##### 7.1.1、用户配置文件

> + 用户信息文件 /etc/passwd
>
>   > root​：x : ​0 : 0 :root:/root:/bin/bash    以冒号分割为7个字段
>   >
>   > 第一个字段： 用户名称     
>   >
>   > 第二个字段：密码标志  x  证明用户有密码
>   >
>   > 第三字段：UUID（用户id）  规范：0：代表超级用户    1-499:代表系统用户（伪用户）  500-65535：普通用户
>   >
>   > 第四个字段：GID（用户初始组ID）
>   >
>   > 第五个字段：用户说明
>   >
>   > 第六个字段：家目录  （普通用户：/home/用户名/   超级用户 ：/root/）
>   >
>   > 第七个字段：登陆之后的shell
>
> + 影子文件 /etc/shadow  存放密码信息 只有root能看
>
>   > 文件权限000
>   >
>   > 第一字段：用户名
>   >
>   > 第二字段：加密密码
>   >
>   > 第三字段：密码最后一次修改日期 1970-1-1之后的天数
>   >
>   > 第四个字段：两次密码修改的间隔时间（和第三个字段相比）
>   >
>   > 第五个字段：密码有效期（和第三个字段相比）
>   >
>   > 第六个字段：密码修改到期前的警告天数（和第五个字段相比）
>   >
>   > 第七个字段：密码到期之后的宽限时间，如果不写或为0，密码到期之后直接封掉， 日过为-1 则代表密码永远不会失效
>   >
>   > 第八个字段：账号失效时间 要使用时间戳表示
>   >
>   > 第九个字段：保留字段
>
> + 组信息文件 /etc/group  和 组密码文件 /etc/gshadow
>
>   > 

##### 7.2.1、用户管理相关文件

> 